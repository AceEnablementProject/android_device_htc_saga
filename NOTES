CyanogenMod Saga Device Notes

Kernel
- drivers/spi/spi_aic3254.c

  The prebuilt kernel is an AOSP kernel by Cayniarb,
  built my myself. Updates from the HTC Pyramid source
  were recently merged and caused audio issues with some
  Saga handsets. This was tracked down to an updated
  drivers/spi/spi_aic3254.c.

  Symptoms of this bug are loss of all sound after the
  handset changes audio profile. With AicBootFix running,
  this happens on phone boot. Without AicBootFix this
  happens once something changes the audio profile, such
  as making or receiving a phone call.

  The current kernel compiles in the original Saga
  spi_aic3254.c instead of the newer one from the Pyramid
  source and this works around the problem. Further
  investigation into the code is needed to find the
  root issue however.


Proprietary Files
- libcamera.so

  The stock HTC Saga libcamera library is from a Sense
  based ROM. For reasons I yet do not understand, it
  does not function correctly when running on an AOSP
  based ROM. The issue lies in userspace rather than the
  kernel as it still fails to function when running an
  AOSP userspace with the stock HTC kernel.

  Currently we use the camera library from an OTA update for
  the HTC Vision (Desire Z). This was released by T-Mobile
  USA which ship their version of the HTC Vision with an
  AOSP ROM not a Sense one. This device is the T-Mobile G2.

  This library functions correctly with our HTC Saga as
  both devices are based on the same MSM7x30 application
  processor, only running at different speeds, and feature
  the same camera hardware.

  Using the stock libcamera.so results in a freeze when
  swapping cameras, once the freeze has occured the camera
  cannot be accessed until a reboot has occurred.


- libhtc_ril.so

  Some Saga handsets exhibit a phone-call disconnection when
  the screen shuts off whilst using the stock Saga RIL. This
  has been traced to a function call in libhtc_ril.so
  "ril_func_screen_state_notified()" trying to access a sysfs
  entry which does not exist on the AOSP kernel:

  /sys/devices/platform/msm_hsusb/usb_function_switch

  This results in a SEGFAULT in the rild process, causing
  the Android to loose the radio momentarily.

  It is currently unknown as to why this doesn't affect
  all Saga handsets but the solution is again to use the
  libhtc_ril.so from the T-Mobile G2 USA OTA update.

  This potentially causes issues with a ril vs radio
  firmware mismatch, but none have been reported so far.
